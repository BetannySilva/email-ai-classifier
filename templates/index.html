<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Classificador de Emails com IA</title>
  <link rel="stylesheet" href="/static/style.css?v=3">
</head>

<body>

  <!-- TOPO -->
  <header class="topo">
    <div class="topo-content">
      <h1 class="title">
        <span class="icon">✨</span>
        Classificador de Emails com IA
      </h1>
      <p class="subtitle">
        Analise seus emails e receba classificação automática de importância
        com sugestões de resposta
      </p>
    </div>
  </header>

  <!-- CONTEÚDO -->
  <main>
    <div class="grid">

      <!-- CARD ESQUERDO -->
      <section class="card">
        <h2 class="card-title">
          <span class="mail-icon">✉</span>
          Email para Análise
        </h2>

        <textarea id="email" placeholder="Cole o conteúdo do email aqui (assunto, remetente e corpo)..."></textarea>

        <button class="btn-primary" onclick="classificar()">
          ✨ Analisar Email
        </button>
      </section>

      <!-- CARD DIREITO -->
      <section class="card">

        <!-- ESTADO VAZIO -->
        <div id="empty" class="empty-state">
          <span class="mail-icon1">✉</span>
          <p id="empty-text">
            Cole um email e clique em "Analisar" para ver os resultados
          </p>
        </div>

        <!-- RESULTADO -->
        <div id="result" class="hidden">
          <p><strong>Categoria:</strong> <span id="categoria"></span></p>
          <h3>Resposta Sugerida</h3>
          <p id="resposta"></p>

          <button class="btn-copy" onclick="copiar()">
            <svg class="copy-icon" viewBox="0 0 24 24">
              <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
            </svg>
            Copiar Resposta
          </button>
        </div>

      </section>
    </div>
  </main>

  <!-- SCRIPT -->
  <script>
    const API = window.location.origin;

    async function classificar() {
      const email = document.getElementById("email").value;
      if (!email.trim()) {
        alert("Cole um email primeiro!");
        return;
      }

      const empty = document.getElementById("empty");
      const emptyText = document.getElementById("empty-text");
      const result = document.getElementById("result");

      emptyText.textContent = "Analisando...";
      empty.classList.remove("hidden");
      result.classList.add("hidden");

      try {
        const res = await fetch(`${API}/classificar`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email })
        });

        if (!res.ok) throw new Error("Erro no servidor");

        const data = await res.json();

        empty.classList.add("hidden");
        result.classList.remove("hidden");

        document.getElementById("categoria").textContent = data.categoria;
        document.getElementById("resposta").textContent = data.resposta;

      } catch (err) {
        emptyText.textContent = "Erro ao analisar. Tente novamente.";
      }
    }

   function copiar() {
  const texto = document.getElementById("resposta").innerText;
  const btn = document.querySelector(".btn-copy");

  navigator.clipboard.writeText(texto).then(() => {
    const textoOriginal = btn.innerHTML;

    btn.innerHTML = "✔ Copiado!";
    btn.style.background = "#22c55e";
    btn.style.color = "white";
    btn.style.border = "none";

    setTimeout(() => {
      btn.innerHTML = textoOriginal;
      btn.style.background = "";
      btn.style.color = "";
      btn.style.border = "";
    }, 2000);
  });
}

  </script>

</body>
</html>
